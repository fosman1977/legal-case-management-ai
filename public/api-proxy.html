<!DOCTYPE html>
<html>
<head>
    <title>Ollama API Proxy</title>
</head>
<body>
    <script>
        // Simple proxy for Ollama API to avoid CORS issues
        async function handleRequest(method, path, body = null) {
            try {
                const response = await fetch(`http://127.0.0.1:11434${path}`, {
                    method,
                    headers: body ? { 'Content-Type': 'application/json' } : {},
                    body: body ? JSON.stringify(body) : null
                });
                
                const data = await response.json();
                return { success: true, data };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        // Listen for messages from the main app
        window.addEventListener('message', async (event) => {
            if (event.origin !== window.location.origin.replace(':5174', ':5173')) return;
            
            const { id, method, path, body } = event.data;
            const result = await handleRequest(method, path, body);
            
            event.source.postMessage({ 
                id, 
                ...result 
            }, event.origin);
        });
        
        // Signal that proxy is ready
        if (window.parent !== window) {
            window.parent.postMessage({ type: 'proxy-ready' }, '*');
        }
    </script>
</body>
</html>